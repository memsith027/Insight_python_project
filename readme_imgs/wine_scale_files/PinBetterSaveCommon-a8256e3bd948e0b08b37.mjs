(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["PinBetterSaveCommon"],{"0zyx":function(e,t,n){n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var o=n("mVx/"),a=n.n(o);const i=({pathname:e})=>/^\/pin\/[\w-]+\/?$/.test(e),r=e=>{const t=a()(e,e=>!i(e));return t&&(({pathname:e})=>/^\/search\/pins\//.test(e))(t)?(({pathname:e,search:t})=>{const n=/^\/search\/pins\/(\?.*)$/.exec(e),o=(t||n&&n[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return o?decodeURIComponent(o[1]):""})(t):""}},"1vym":function(e,t,n){},"7vSn":function(e,t,n){},EuRG:function(e,t,n){function o(e,t){return{type:"SEARCH_PIN_CLOSEUP_VIEWED",payload:{pinId:e,query:t}}}function a(e){return{type:"SEARCH_QUERY_STARTED",payload:{query:e}}}function i(e){return{type:"SEARCH_QUERY_INVALIDATED",payload:{query:e}}}n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}))},"H/Lk":function(e,t,n){n.d(t,"a",(function(){return o}));const o=(e,t,n)=>({type:"MOST_RECENT_BOARD",payload:{id:e,name:t,url:n}})},JELi:function(e,t,n){var o=n("KwMD"),a=n("ut/Y"),i=n("Sxd8"),r=Math.max,s=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var l=c-1;return void 0!==n&&(l=i(n),l=n<0?r(c+l,0):s(l,c-1)),o(e,a(t,3),l,!0)}},KwMD:function(e,t){e.exports=function(e,t,n,o){for(var a=e.length,i=n+(o?1:-1);o?i--:++i<a;)if(t(e[i],i,e))return i;return-1}},WnNx:function(e,t,n){function o(e){return{type:"SHOW_REPIN_ANIMATION",payload:{pinId:e}}}function a(){return{type:"HIDE_REPIN_ANIMATION"}}function i(){return{type:"SHOW_USECASE_FLYOUT"}}function r(){return{type:"HIDE_USECASE_FLYOUT"}}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r}))},XKAG:function(e,t,n){var o=n("ut/Y"),a=n("MMmD"),i=n("7GkX");e.exports=function(e){return function(t,n,r){var s=Object(t);if(!a(t)){var c=o(n,3);t=i(t),n=function(e){return c(s[e],e,s)}}var l=e(t,n,r);return l>-1?s[c?t[l]:l]:void 0}}},ZdPf:function(e,t,n){n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r}));const o={CONDITIONAL:0,EMOTIONAL_DISDRESS_OR_SUICIDE:4},a={ABUSIVE:0,SENSITIVE:1,BRAND_UNSAFE:2};function i(e){return null!=e&&(!!e.notice||!!e.notices&&e.notices.length>0)}function r(e){return!!e&&e.severity===a.ABUSIVE}},a49R:function(e,t,n){n.d(t,"a",(function(){return s}));var o=n("q1tI"),a=n.n(o),i=(n("17x9"),n("n6mq"));function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=a.a.createContext(()=>{}),c=752;t.b=class extends o.Component{constructor(...e){super(...e),r(this,"state",{flyout:void 0,showOnTopOfModal:!1}),r(this,"setActive",(e,t,n=!1)=>{if(e){const e={...t,onDismiss:()=>{t&&t.onDismiss&&(t.onDismiss(),this.setState({flyout:void 0}))},positionRelativeToAnchor:!1};this.setState({flyout:{props:e},showOnTopOfModal:n})}else this.setState({flyout:void 0})})}render(){var e,t,n,o,r,l,d,u,h;const{flyout:p,showOnTopOfModal:m}=this.state,{children:g}=this.props;return a.a.createElement(a.a.Fragment,null,a.a.createElement(s.Provider,{value:this.setActive},g),p&&a.a.createElement("div",m?{style:{zIndex:c,position:"absolute",top:0}}:{},a.a.createElement(i.n,{anchor:null===(e=p.props)||void 0===e?void 0:e.anchor,onDismiss:null===(t=p.props)||void 0===t?void 0:t.onDismiss,color:null===(n=p.props)||void 0===n?void 0:n.color,idealDirection:null===(o=p.props)||void 0===o?void 0:o.idealDirection,positionRelativeToAnchor:null===(r=p.props)||void 0===r?void 0:r.positionRelativeToAnchor,shouldFocus:null===(l=p.props)||void 0===l?void 0:l.shouldFocus,showCaret:null===(d=p.props)||void 0===d?void 0:d.showCaret,size:null===(u=p.props)||void 0===u?void 0:u.size},null===(h=p.props)||void 0===h?void 0:h.children)))}}},e0nq:function(e,t,n){function o(e){return{type:"PIN_BETTER_SAVE",payload:e}}function a(e){return{type:"PIN_BETTER_UNSAVE",payload:e}}function i(e){return{type:"PIN_BETTER_SELECT_BOARD_OR_SECTION",payload:e}}function r(e){return{type:"POST_REPIN_MORE_IDEAS_UPSELL_SHOWN",payload:{boardId:e}}}n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r}))},e3KR:function(e,t,n){var o=n("q1tI"),a=n.n(o),i=n("/MKj"),r=(n("7vSn"),n("8cMa")),s=n("n6mq");var c=({isOpen:e,showCollaborativeIcon:t,showPrivateIcon:n,showProtectedIcon:o,showSectionsIcon:i})=>t||n||o||i?a.a.createElement(s.d,{display:"flex",direction:"row",marginEnd:5,dangerouslySetInlineStyle:{__style:{paddingLeft:8}},alignItems:"center"},n&&a.a.createElement(r.a,{type:"secret"}),o&&a.a.createElement(r.a,{type:"protected"}),t&&a.a.createElement(r.a,{type:"group"}),i&&a.a.createElement(r.a,{type:"sections"})):null,l=n("JW66"),d=n("Ye/N"),u=n("4cpq");function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p=52;class m extends o.Component{constructor(...e){super(...e),h(this,"state",{hovered:!1}),h(this,"handleMouseEnter",()=>{this.setState({hovered:!0})}),h(this,"handleMouseLeave",()=>{this.setState({hovered:!1})}),h(this,"handleTouch",()=>{const{board:e,onClick:t}=this.props;t(e)}),h(this,"handleButtonClick",({event:e})=>{const{onButtonClick:t}=this.props;this.handleTouch(),t&&t(),e.stopPropagation()}),h(this,"tapAreaRef",Object(o.createRef)())}focus(){const e=this.tapAreaRef.current;e&&e.focus()}render(){const{hovered:e}=this.state,{board:t,buttonText:n,isSectionOpen:o,shouldOpenSections:i,showFlyoutSaveButton:r}=this.props,h=!!t.section_count&&t.section_count>0,m=h?"boardWithSection":"boardWithoutSection",g=t.image_cover_url;return a.a.createElement(u.a,{id:m},a.a.createElement(s.Q,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTap:this.handleTouch,ref:this.tapAreaRef},a.a.createElement(s.d,{color:e?"lightGray":"white",display:"flex",alignItems:"center",height:p,marginStart:3,marginEnd:3,marginBottom:1,marginTop:1,rounding:3},a.a.createElement(s.d,{flex:"none",marginBottom:1,marginStart:2,marginEnd:3,marginTop:1,overflow:"hidden",width:36,height:36,rounding:2},g&&!i&&a.a.createElement(s.x,{wash:!0,width:36,height:36},a.a.createElement(s.s,{src:g,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"})),g&&i?a.a.createElement(s.x,{wash:!0,width:36,height:36},a.a.createElement(s.s,{src:g,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"})):a.a.createElement(s.d,{color:i?"lightGray":"transparent",width:"100%",height:"100%"})),a.a.createElement(s.d,{flex:"grow",paddingY:1,overflow:"hidden",marginStart:1},a.a.createElement(s.R,{truncate:!0,weight:i||!i?"bold":"normal"},t.name)),t&&(!e||e&&h&&!o)?a.a.createElement(s.d,null,a.a.createElement(c,{isOpen:t.isOpen,showCollaborativeIcon:!!t.is_collaborative,showPrivateIcon:t.privacy===l.a.BoardPrivacy.SECRET,showProtectedIcon:t.privacy===l.a.BoardPrivacy.PROTECTED,showSectionsIcon:h&&i})):null,e&&(0===t.section_count||!i)&&r&&a.a.createElement(s.d,{marginEnd:2,flex:"none"},a.a.createElement(s.e,{accessibilityLabel:"save button",color:"red",inline:!0,onClick:this.handleButtonClick,text:n||d.a._("Save","save button","save button")})))))}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}h(m,"defaultProps",{shouldOpenSections:!0,showFlyoutSaveButton:!0});const b=52,f=53,v=11;class S extends o.Component{constructor(...e){super(...e),g(this,"state",{hovered:!1}),g(this,"handleMouseEnter",()=>{this.setState({hovered:!0})}),g(this,"handleMouseLeave",()=>{this.setState({hovered:!1})}),g(this,"handleTouch",()=>{const{board:e,onClick:t,section:n}=this.props;t(n,e)}),g(this,"handleButtonClick",({event:e})=>{const{onButtonClick:t}=this.props;this.handleTouch(),t&&t(),e.stopPropagation()}),g(this,"tapAreaRef",Object(o.createRef)())}focus(){const e=this.tapAreaRef.current;e&&e.focus()}render(){const{hovered:e}=this.state,{buttonText:t,section:n,showSectionSaveButton:o}=this.props;return a.a.createElement(s.Q,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTap:this.handleTouch,ref:this.tapAreaRef},a.a.createElement(s.d,{color:e?"lightGray":"white",display:"flex",alignItems:"center",height:b,marginTop:1,rounding:3,dangerouslySetInlineStyle:{__style:{marginLeft:f,marginRight:v}}},a.a.createElement(s.d,{flex:"grow",paddingY:1,marginStart:4},a.a.createElement(s.R,{truncate:!0},n.title)),e&&o&&a.a.createElement(s.d,{marginEnd:2,flex:"none"},a.a.createElement(s.e,{accessibilityLabel:"save button",color:"red",inline:!0,text:t||d.a._("Save","save button","save button"),onClick:this.handleButtonClick}))))}}g(S,"defaultProps",{showSectionSaveButton:!0});var _=n("zLLH");var y=Object(_.c)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id})},{allowStale:!1})(e=>{const{board:t,buttonText:n,sectionsResource:o,onClick:i,onButtonClick:r,showSectionSaveButton:c}=e,l=o&&o.data||[];return a.a.createElement(s.d,null,!o.isLoaded&&a.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},a.a.createElement(s.K,{accessibilityLabel:d.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})),o.isLoaded&&a.a.createElement(s.d,null,l.map(e=>a.a.createElement(S,{board:t,buttonText:n,key:e.id,onButtonClick:r,onClick:i,section:e,showSectionSaveButton:c}))))});function E({isBoardCreate:e,onCreateBoardClick:t}){const[n,i]=Object(o.useState)(!1);return a.a.createElement(s.d,{"data-test-id":"create-board",height:"100%",display:"flex"},a.a.createElement(s.Q,{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onTap:t,rounding:2},a.a.createElement(s.d,{display:"flex",alignItems:"center",color:n?"lightGray":"white",padding:2,width:"100%",height:"100%"},a.a.createElement(s.d,{marginEnd:5,marginStart:4},a.a.createElement(s.q,{accessibilityLabel:"",size:28,icon:"add-circle",color:"red"})),e?a.a.createElement(s.R,{align:"center",truncate:!0,weight:"bold"},d.a._("Create board")):a.a.createElement(s.R,{align:"center",truncate:!0,weight:"bold"},d.a._("Create section")))))}var w=n("nKlH");const B=52;function C({onClick:e,title:t}){const[n,i]=Object(o.useState)(!1);return a.a.createElement(s.Q,{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onTap:()=>{e({title:t})}},a.a.createElement(s.d,{color:n?"lightGray":"white",display:"flex",alignItems:"center",height:B,marginStart:3,marginEnd:3,marginBottom:1,rounding:3},a.a.createElement(s.d,{flex:"none",marginBottom:1,marginStart:2,marginEnd:3,marginTop:1,overflow:"hidden",width:36,height:36,rounding:1},a.a.createElement(s.d,{color:"lightGray",width:"100%",height:"100%"})),a.a.createElement(s.d,{flex:"grow",paddingY:1},a.a.createElement(s.R,{truncate:!0,weight:"bold"},t)),n&&a.a.createElement(s.d,{marginEnd:2},a.a.createElement(s.e,{accessibilityLabel:"create button",color:"red",inline:!0,text:d.a._("Create","create button to create a new board","create button to create a new board")}))))}const I=e=>{const{suggestionsResource:t,onClick:n,pinBuilderSuggestions:o}=e,i=o||t&&t.data||[],r=a.a.createElement(a.a.Fragment,null,i.map((e,t)=>a.a.createElement(C,{key:t,title:e.title,onClick:n})));return a.a.createElement(a.a.Fragment,null,i?r:a.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},a.a.createElement(s.K,{accessibilityLabel:d.a._("loading board suggestions","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})))};var R=n("0BOE"),x=n("eUcp"),O=n("Wer7"),T=n("qyR9"),D=n("U4JR"),P=n("oTtT"),k=n("fArA");function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"c",(function(){return W})),n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return G}));const j=128.5,A=439,M=52;class F extends o.Component{constructor(...e){super(...e),L(this,"state",{isSectionOpen:null,selectedBoardId:"",selectedBoardCategory:"",searchQuery:"",searchBoxFocused:!0}),L(this,"getItems",()=>{const{boardResource:e,suggestedBoardsShortListResource:t}=this.props;if(!e||!e.data)return[];const{all_boards:n}=e&&e.data,o=n.filter(e=>!this.props.advertiser_id||"secret"!==e.privacy).map(e=>this.mapBoards(e,"allBoards",0)),a=(t&&t.data||[]).map((e,t)=>this.mapBoards(e,"shortlist",t+1)),{searchQuery:i}=this.state;return i.length>=T.a?[...Object(R.a)(o,i)]:[...o.length>3&&a&&a.length?[{type:"header",title:d.a._("Top board suggestions","Header for top suggesions in board picker","Header for top suggesions in board picker")},...a]:[],{type:"header",title:d.a._("All boards","Header for all boards in board picker","Header for all boards in board picker")},...o,...o.length<=3?[{type:"header",title:d.a._("Suggested board names","Header for suggested boards in board picker","Header for suggested boards in board picker")}]:[]]}),L(this,"mapBoards",(e,t,n)=>{const{setBoardWithSection:o}=this.props,{selectedBoardId:a,selectedBoardCategory:i}=this.state,r=e.id===a&&t===i;return r&&o&&o(e),{...e,category:t,isOpen:r,gridIndex:n}}),L(this,"handleBack",()=>{const{setBoardWithSection:e}=this.props;this.setState({isSectionOpen:!1,selectedBoardId:"",selectedBoardCategory:""}),e&&e(null)}),L(this,"handleSectionClick",(e,t)=>{const{onItemChosen:n}=this.props;Object(D.a)(101,{component:13282,element:36,objectId:t.id,view:91,grid_index:t.gridIndex}),n({boardId:t.id,url:e.slug?`${t.url}${e.slug}/`:t.url,sectionId:e.id,title:e.title||"",imageCoverUrl:t.image_cover_url})}),L(this,"handleBoardWithSectionsClick",e=>{const{selectedBoardId:t,selectedBoardCategory:n}=this.state,o=t===e.id&&n===e.category;this.setState({isSectionOpen:!0,selectedBoardId:o?"":e.id,selectedBoardCategory:o?"":e.category})}),L(this,"handleBoardClick",({board:e,toggleSections:t})=>{const{onItemChosen:n}=this.props;this.setState({searchBoxFocused:!1}),t?this.handleBoardWithSectionsClick({id:e.id,category:e.category}):(Object(D.a)(101,{component:13282,element:36,objectId:e.id,view:91,grid_index:e.gridIndex}),n({boardId:e.id,url:e.url,title:e.name||"",imageCoverUrl:e.image_cover_url}))}),L(this,"handleSearchQueryUpdate",e=>{this.setState(t=>({...t,searchQuery:e}))}),L(this,"boardSectionsHeaderRef",Object(o.createRef)())}componentDidMount(){this.props.boardResource&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd()}componentDidUpdate(e,t){e.boardResource&&!e.boardResource.isLoaded&&this.props.boardResource&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd(),this.state.isSectionOpen&&!t.isSectionOpen&&this.boardSectionsHeaderRef.current&&this.boardSectionsHeaderRef.current.focus()}setPWTLoadingEnd(){const{boardResource:e,boardPickerStopwatch:t}=this.props;t&&(!e||e.error?t.error():t.stop())}render(){const{boardResource:e,buttonText:t,customItem:n,onBoardCreate:o,onButtonClick:i,paneWidth:r,showCreateBoardButton:c,showFlyoutSaveButton:l,showSections:h,showSectionSaveButton:p,suggestedBoardsShortListResource:g,useStoryboardStyle:b}=this.props,{isSectionOpen:f,searchBoxFocused:v,searchQuery:S}=this.state;if(!e)return null;const{isLoaded:_,data:B,error:C}=e;let R=[];(_&&!C||g&&g.data&&!g.error)&&(R=this.getItems());const O=R.filter(e=>e&&"allBoards"===e.category).length,T=b?200:322,D=b?214:334,P=null===f?"":"BoardsSlideRight",k=_&&B&&B.create_suggestions.map(e=>({title:e}))||[],L=e=>a.a.createElement(a.a.Fragment,null,a.a.createElement(s.l,null),a.a.createElement(s.d,{overflow:"hidden",height:M,dangerouslySetInlineStyle:{__style:{borderBottomRightRadius:8,borderBottomLeftRadius:8}}},a.a.createElement(E,{onCreateBoardClick:()=>o({title:this.state.searchQuery}),isBoardCreate:e})));return a.a.createElement(s.d,{width:"100%",rounding:2,overflow:"hidden",height:b?"100%":A,color:"white",dangerouslySetInlineStyle:{__style:{zIndex:x.b}}},_?null:a.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:r,height:"100%",minHeight:200},a.a.createElement(s.K,{accessibilityLabel:d.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})),a.a.createElement(s.d,{display:"flex",direction:"row"},_&&a.a.createElement("div",{className:f?"BoardsSlideLeft":P},a.a.createElement(s.d,{position:"relative"},a.a.createElement(s.d,{display:"flex",direction:"row",width:2*r,dangerouslySetInlineStyle:{__style:{zIndex:0}}},a.a.createElement(s.d,{display:"flex",direction:"column",width:r},a.a.createElement(s.d,{padding:3},a.a.createElement(w.a,{accessibilityLabel:d.a._("Search through your boards","search bar placeholder text","search bar placeholder text"),focused:v,id:"pickerSearchField",onChange:({value:e})=>this.handleSearchQueryUpdate(e),placeholder:d.a._("Search","search bar placeholder text","search bar placeholder text"),value:S})),a.a.createElement(s.d,{minHeight:T,maxHeight:T,overflow:"scrollY"},g&&!g.isLoaded?a.a.createElement(u.a,{id:"suggestedBoardsContainer"},a.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:j},a.a.createElement(s.K,{accessibilityLabel:d.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0}))):null,n,R.map((e,n)=>"header"===e.type?a.a.createElement(s.d,{key:e.title,paddingX:3,paddingY:1,marginTop:n>0?2:1},a.a.createElement(s.R,{size:"md"},e.title)):a.a.createElement(s.d,{key:`${e.category}-${e.id}`},a.a.createElement(m,{board:e,buttonText:t,onClick:e=>{this.handleBoardClick({board:e,toggleSections:h&&!!e.section_count})},onButtonClick:i,shouldOpenSections:h,showFlyoutSaveButton:l}))),O<=3&&a.a.createElement(I,{onClick:o,pinBuilderSuggestions:k})),c&&L(!0)),a.a.createElement(s.d,{display:"flex",direction:"column",width:r},a.a.createElement(s.d,{display:"flex",direction:"row",justifyContent:"center",alignContent:"center",alignItems:"center"},a.a.createElement(s.i,{span:2},a.a.createElement(s.d,{display:"flex",justifyContent:"start",alignContent:"center",alignItems:"center",marginStart:3},a.a.createElement(s.r,{accessibilityLabel:"Back button",icon:"arrow-back",iconColor:"darkGray",onClick:this.handleBack,size:"sm"}))),a.a.createElement(s.i,{span:8},a.a.createElement(s.d,{display:"flex",justifyContent:"center",alignItems:"center",height:52},a.a.createElement(s.R,{weight:"bold"},d.a._("Choose section","Header for section header","Header for section header")))),a.a.createElement(s.i,{span:2},a.a.createElement(s.d,null))),a.a.createElement(s.l,null),a.a.createElement(s.d,{minHeight:D,maxHeight:D,overflow:"scrollY"},R?a.a.createElement(a.a.Fragment,null,R&&R.map((e,n)=>"header"===e.type?null:a.a.createElement(s.d,{key:`${e.category}-${e.id}`},e.isOpen&&a.a.createElement(a.a.Fragment,null,a.a.createElement(m,{board:e,buttonText:t,isSectionOpen:!0,onClick:e=>{this.handleBoardClick({board:e,toggleSections:!1})},onButtonClick:i,shouldOpenSections:!1,showFlyoutSaveButton:l,ref:this.boardSectionsHeaderRef}),a.a.createElement(y,{board:e,buttonText:t,onClick:this.handleSectionClick,onButtonClick:i,showSectionSaveButton:p}))))):null),c&&L(!1)))))))}}function N(e){const t=Object(P.b)();return a.a.createElement(F,Object.assign({},e,{boardPickerStopwatch:t}))}function H(e){const{advertiser:t,viewer:n}=e;if(n&&t){const t=e.advertiser;if(n.isAuth&&t.owner_user_id!==n.id)return{hasMUA:!0,advertiser_id:t.id,username:t.owner_user_id};if(n.isAuth&&t.owner_user_id===n.id)return{hasMUA:!1,advertiser_id:t.id,username:"me"}}return{advertiser_id:void 0,hasMUA:void 0,username:void 0}}function U(e){const{advertiser_id:t,hasMUA:n,username:o}=e;return{field_set_key:"board_picker",filter:n?"protected":"all",...o?{username:o}:{},...t?{advertiser_id:t}:{}}}function W(){return(e,t)=>e(Object(O.f)("BoardPickerBoardsResource",U(H(t()))))}L(F,"defaultProps",{paneWidth:320,showCreateBoardButton:!0,showFlyoutSaveButton:!0,showSections:!0,showSectionSaveButton:!0});const q=Object(k.compose)(Object(i.connect)((function(e){return H(e)})),Object(_.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:U}))(N),G=Object(_.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsShortListResource",options:e=>({pin_id:e.pin.id,shortlist_length:3,num_shortlist_suggestions:3})})(N)},eUcp:function(e,t,n){n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return u}));const o=1,a=2,i=2,r=3,s=1,c=3,l=3,d=4,u=100},fEA9:function(e,t,n){n.r(t);var o=n("q1tI"),a=n.n(o),i=n("/MKj"),r=(n("1vym"),n("qWlA")),s=n("TSYQ"),c=n.n(s),l=n("clxp"),d=n("1inl"),u=n("ajUs"),h=n("Ye/N"),p=n("a49R");class m extends o.Component{constructor(...e){var t,n,o;super(...e),o=()=>{const{setActive:e,showOnTopOfModal:t,...n}=this.props;e("flyout",n,t||!1)},(n="renderFlyout")in(t=this)?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o}componentDidMount(){this.renderFlyout()}componentDidUpdate(){this.renderFlyout()}componentWillUnmount(){this.props.setActive()}render(){return null}}const g=e=>o.createElement(p.a.Consumer,null,t=>o.createElement(m,Object.assign({},e,{setActive:t})));g.displayName="MasonryFlyout";var b=g,f=n("3gA6"),v=n("jHGc"),S=n("eOdZ"),_=n("/5zs"),y=n("pLLR"),E=n("lm6u");const w=(e,t)=>{const[n,a]=Object(o.useState)([]),i=Object(y.d)();return Object(o.useEffect)(()=>{let n=!1;if(e){new _.c(i,"web_board_section_templates").enabled()&&S.a.create("SectionRecommendationsResource",{pinIds:[t]}).callGet().then(e=>{var t;if(n)return;const o=null==e?void 0:null===(t=e.resource_response)||void 0===t?void 0:t.data;a(o.length>0&&o[0]||[])})}return()=>{n=!0}},[e,t]),n};function B(e){const{action:t,additionalCreateFields:n,boardWithSection:o,children:i,onClose:r,pin:s,setCompletionPromise:c,showModal:l}=e,d=w(l,s.id);return a.a.createElement(E.a,{additionalCreateFields:n,boardWithSection:o,action:t,hideSuccessAnimation:!!d.length,onClose:r,setCompletionPromise:c,showCreate:!0,shouldShowToast:!d.length,pin:s},e=>i({...e,sectionSuggestions:d}))}var C=n("e3KR"),I=n("Wrea"),R=n("fArA"),x=n("0zyx"),O=n("TN0d"),T=n("vvax"),D=n("EuRG"),P=n("H/Lk"),k=n("WnNx"),L=n("U4JR"),j=n("NjDU"),A=n("CvCA"),M=n("e0nq");const F=5e3,N=16,H=({boardId:e,boardUrl:t,postRepinMoreIdeasUpsell:n})=>{if(!t)return!1;const{recentSaves:o,recentUpsell:a}=n;if(a[e])return!1;const i=o.findIndex(t=>t.boardId!==e);return(-1===i?o.length:i)+1>=3};var U=Object(i.connect)(null,(e,t)=>({toastShown:()=>e(Object(M.c)(t.boardId))}))(class extends o.PureComponent{constructor(...e){var t,n,o;super(...e),o=()=>{const{boardId:e}=this.props;Object(L.a)(101,{component:20,element:10805,objectId:e})},(n="handleClick")in(t=this)?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o}componentDidMount(){const{toastShown:e}=this.props;e()}render(){const{boardName:e,boardUrl:t,onHide:n}=this.props;return o.createElement(A.a,{duration:F,onHide:n,text:Object(T.b)(h.a._("Find more ideas for {{ boardName }}"),{boardName:e}).join(""),href:`${t}more_ideas/?ideas_referrer=${N}`,onClick:this.handleClick})}}),W=n("zLLH"),q=n("C0mq"),G=n("ZdPf"),z=n("B6Tf"),Q=n("oTtT"),K=n("nGHF"),Y=n("n6mq"),$=n("0nTG");function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"PinBetterSave",(function(){return ee}));const X={CLASSIC:40,LEGO:44},J=4;function Z({savedInfo:e,variant:t}){const n="lego-closeup"===t,o=n?"sm":"md";return a.a.createElement(f.b,{className:"underlineLink",stopPropagation:!0,style:{color:"#333"},to:e.url||""},a.a.createElement(Y.d,{marginStart:n?1:0},a.a.createElement(Y.R,{color:"darkGray",inline:!0,size:o},Object(T.b)(h.a._("Saved to {{ destination }}","Saved to label for better save","Saved to label for better save"),{destination:a.a.createElement(Y.R,{color:"darkGray",key:"pin_auto_save_link",size:o,truncate:!0,weight:"bold"},e.title)}))))}class ee extends a.a.Component{constructor(...e){var t;super(...e),t=this,V(this,"state",{boardWithSection:null,buttonRef:null,createdBoard:null,suggestedBoardTitle:"",showBoardFlyout:!1,showRepinModal:!1,sensitiveContentNotice:null}),V(this,"saveButtonRef",e=>{this.setState({buttonRef:e})}),V(this,"setBoardSaveCompletionPromise",e=>{const{createdBoard:t}=this.state;this._repinCompletionPromise=e,this._repinCompletionPromise.promise.then(e=>{if(!e.board)return;const{board:{id:n,name:o,url:a}}=e,i={boardId:n,title:o,url:a};this.updateSelectedBoardOrSection(i),this.updateSavedState({...i,localPinId:e.id}),t&&Object(G.d)(t.sensitivity)&&Object(G.c)(t.sensitivity)?this.setState({sensitiveContentNotice:t.sensitivity.notice||t.sensitivity.notices[0]}):this.handleRepinHide()})}),V(this,"updateSavedState",e=>{const{reduxLocation:t,save:n,searchQueryInvalidated:o,onSave:a,pin:{id:i}}=this.props,r=t.query&&t.query.q||Object(x.a)(t.history);n({pinId:i,...e}),r&&o(r),a&&a()}),V(this,"updateSelectedBoardOrSection",e=>{const{selectBoardOrSection:t,pin:{id:n}}=this.props;t({pinId:n,...e})}),V(this,"updateSelectedItem",()=>{const{initialSelection:e,selectedItem:t}=this.props;!t&&e&&this.updateSelectedBoardOrSection(e)}),V(this,"dropdownRef",a.a.createRef()),V(this,"handleItemChosen",e=>{this.updateSelectedBoardOrSection(e),this.hideFlyout(!0),this.save(e)}),V(this,"handleBoardCreate",Object(r.a)(({title:e=""}={})=>{this.hideFlyout(!0),this.setState(t=>({...t,suggestedBoardTitle:e,showRepinModal:!0}));const{onToggleFlyout:t}=this.props;t&&t(!0,!0)})),V(this,"handleBoardCreated",e=>{this.setState({createdBoard:e})}),V(this,"handleRepinHide",()=>{this.setState(e=>({...e,suggestedBoardTitle:"",showRepinModal:!1}));const{onToggleFlyout:e}=this.props;e&&e(!1,!1)}),V(this,"handleBoardDropdownClick",e=>{const{pin:{id:t},viewParameter:n,boardPickerStopwatch:o}=this.props;e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),this.state.showBoardFlyout?this.hideFlyout(!0):(Object(L.a)(101,{component:13282,element:10960,viewParameter:n,objectId:t}),o&&o.start(),this.showFlyout())}),V(this,"handleSaveClick",(async function(e){const{selectedItem:n}=t.props;n?(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),Object(L.a)(101,{component:13282,element:36,objectId:n.boardId,grid_index:J}),await t.save(n)):t.handleBoardDropdownClick(e)})),V(this,"setBoardWithSection",e=>{this.setState({boardWithSection:e})}),V(this,"handleEditSubmit",({boardId:e,sectionId:t,url:n,title:o})=>{const{pin:{id:a},savedInfo:{localPinId:i}={}}=this.props;this.updateSavedState({pinId:a,localPinId:i,boardId:e,sectionId:t||"",url:n,title:o})}),V(this,"resetPinSavedState",()=>{this.updateSavedState({boardId:"",localPinId:"",sectionId:"",title:"",url:""})}),V(this,"deleteSavedState",()=>{const{unsave:e,onDelete:t,pin:{id:n}}=this.props;e({pinId:n}),t&&t()}),V(this,"save",(async function(e){const{isLimitedLogin:n,mostRecentBoard:o,pin:{id:i},postRepinMoreIdeasUpsell:r,postRepinUpsellDisabled:s,save:c,setMostRecentBoard:l,showRepinAnimation:u,toastManagerContext:h}=t.props;t.updateSavedState(e);try{const{resource_response:{data:n}}=await t.getPinResource(e).callCreate({showError:!1}),d=e.url,{incrementBoardPinCount:p,updateUserPinCount:m,viewerUserId:g}=t.props;!s&&d&&H({boardId:e.boardId,boardUrl:d,postRepinMoreIdeasUpsell:r})&&h.showToast(({onHide:t})=>a.a.createElement(U,{boardId:e.boardId,boardName:e.title,boardUrl:d,onHide:t})),c({pinId:i,...e,localPinId:n.id}),O.b.publish("currentUser","pinCreated",n),O.b.publish(n.board.id,"pinCreated",{pin:n}),p({boardId:e.boardId,sectionId:e.sectionId}),m(g),u(i),o&&e.boardId!==o.id&&l(e.boardId,e.title,e.url)}catch(p){n||d.a.showError(p.message_detail||p.message),t.resetPinSavedState()}})),V(this,"hideFlyout",(e=!1)=>{const{onToggleFlyout:t}=this.props;this.setState({showBoardFlyout:!1}),t&&t(!1,e)})}componentDidMount(){const{onMount:e}=this.props;this.updateSelectedItem(),e&&e()}componentDidUpdate(e,t){this.updateSelectedItem()}getPinResource(e){const{carousel_data:t,location:n,previousHistory:o,pin:a}=this.props,i=t&&t.index,r=Object(u.a)(a,n,o)||`${a.tracking_params}~0`,s={description:a.description||"",link:a.link,title:a.title||"",clientTrackingParams:r,board_id:e.boardId||"",pin_id:a.id||"",image_base64:a.image_base64,is_buyable_pin:!1,is_removable:a.promoted_is_removable,carousel_slot_index:i||0,...e.sectionId?{section:e.sectionId}:{},...Object($.a)(a)||{}};return S.a.create("RepinResource",s)}showFlyout(){const{onToggleFlyout:e}=this.props;this.setState({showBoardFlyout:!0}),e&&e(!0,!0)}render(){const{boardResource:e,useMasonryFlyout:t,onToggleModal:n,pin:o,requestContext:i,renderSavedStatus:r,renderPinSaveTooltip:s,selectedItem:d,savedInfo:u,unselectedText:p,variant:m,viewParameter:g}=this.props,{boardWithSection:f,buttonRef:S,showBoardFlyout:_,showRepinModal:y,sensitiveContentNotice:E,suggestedBoardTitle:w}=this.state,I=t?b:Y.n,{carousel_data:R}=o,x="lego-closeup"===m||"lego-pin"===m,O=x?"sm":"md";let T={};"lego-closeup"===m?T={bgColor:"transparent",iconColor:"darkGray",size:"sm"}:"lego-pin"===m?T={bgColor:"white",iconColor:"darkGray",size:"sm"}:"pin"===m&&(T={bgColor:"transparentDarkGray",iconColor:"white",size:"sm"});const D=r&&u&&r({savedInfo:u,variant:m}),P=a.a.createElement(C.a,{boardResource:e,setBoardWithSection:this.setBoardWithSection,onItemChosen:this.handleItemChosen,onBoardCreate:this.handleBoardCreate,pin:o});return a.a.createElement(l.a,{name:"PinBetterSave"},a.a.createElement(Y.d,{width:"100%",display:"lego-closeup"===m?"flex":void 0,height:"lego-closeup"===m?X.LEGO:void 0,color:"lego-closeup"===m?"lightGray":void 0,rounding:"lego-closeup"===m?4:void 0},(null==u?void 0:u.title)?a.a.createElement(Y.d,{display:"flex",direction:"row",alignItems:"center",width:"lego-closeup"===m?"100%":void 0,paddingX:"lego-closeup"===m?2:void 0,marginStart:"lego-pin"===m?-1:void 0,marginEnd:"lego-pin"===m?-1:void 0},D&&a.a.createElement(Y.d,{paddingX:1,"data-test-id":"saved-info",flex:"grow"},D),a.a.createElement(Y.d,{paddingX:1,flex:"none",marginStart:"auto"},a.a.createElement(v.default,{component:0,onDelete:this.deleteSavedState,onSubmit:this.handleEditSubmit,pinId:u.localPinId,onToggleModal:n,viewParameter:g,carouselSlotCurrentIndex:R&&R.index,style:T,useLegoStyles:"lego-pin"===m}))):a.a.createElement(Y.d,{alignItems:"center",display:"flex",width:"100%",height:x?X.LEGO:X.CLASSIC},a.a.createElement("button",{className:c()("PinBetterSave__Dropdown",{"PinBetterSave__Dropdown--rtl":i.isRTL,"PinBetterSave__Dropdown--lego":x,"PinBetterSave__Dropdown--lego-pin":"lego-pin"===m,"PinBetterSave__Dropdown--lego-closeup":"lego-closeup"===m,"PinBetterSave__Dropdown--expanded":_&&!x,"PinBetterSave__Dropdown--expandedLego":_&&x}),"data-test-id":"PinBetterSaveDropdown",onClick:this.handleBoardDropdownClick,ref:this.dropdownRef},a.a.createElement(Y.d,{paddingX:4,display:"flex",flex:"grow",alignItems:"center"},a.a.createElement(Y.d,{flex:"grow",minWidth:0,overflow:"hidden"},d&&d.title?a.a.createElement(Y.R,{truncate:!0,size:O},a.a.createElement("span",{className:c()("PinBetterSave__DropdownText",{"PinBetterSave__DropdownText--lego":x})},d.title)):a.a.createElement(Y.R,{color:"gray",truncate:!0,size:O},a.a.createElement("span",{className:c()("PinBetterSave__DropdownText",{"PinBetterSave__DropdownText--lego":x})},p))),a.a.createElement(Y.d,{marginStart:2,flex:"none","data-test-id":"boardSelectionDropdown"},a.a.createElement("div",{className:c()("PinBetterSave__DownArrowContainer",{"PinBetterSave__DownArrowContainer--lego":x})},a.a.createElement(Y.q,{accessibilityLabel:h.a._("Select a board you want to save to","BetterSave accessibility label to change the board","BetterSave accessibility label to change the board"),color:"darkGray",icon:"arrow-down",size:12}))))),!_&&a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{className:c()("PinBetterSave__Button",{"PinBetterSave__Button--rtl":i.isRTL,"PinBetterSave__Button--lego":x,"PinBetterSave__Button--lego-pin":"lego-pin"===m}),onClick:this.handleSaveClick,"data-test-id":"PinBetterSaveButton",ref:this.saveButtonRef},a.a.createElement(Y.R,{color:"white",size:O,weight:"bold"},h.a._("Save","BetterSave Save label","BetterSave Save label"))),!!s&&!!S&&s(S))),a.a.createElement(B,{additionalCreateFields:{is_stl_pin:Object($.g)(o)},boardWithSection:f,action:"create",onClose:this.handleRepinHide,setCompletionPromise:this.setBoardSaveCompletionPromise,showModal:y,pin:o},({boardSavedTo:e,dismissModal:t,displaySuccessAnimation:n,handleAbort:o,handleNewBoardAnimationCompletion:i,handleSocialConnectSet:r,handleSaveToBoard:s,newPin:c,updateDescription:l,modalTitle:d,sectionSuggestions:u,setModalTitle:h,pin:p})=>a.a.createElement(z.b,{boardSavedTo:e,isInModal:!0,displaySuccessAnimation:n,dismissModal:t,handleAbort:o,handleNewBoardAnimationCompletion:i,handleSocialConnectSet:r,handleSaveToBoard:s,updateDescription:l,onBoardCreated:this.handleBoardCreated,sensitiveContentNotice:E,pin:p,pwtAuxData:{pin_create_method:"repin"},sectionSuggestions:u,suggestedBoardTitle:w,boardWithSection:f,shouldRenderContent:y,newPin:c,modalTitle:d,setModalTitle:h,showCreate:!0})),_&&"lego-closeup"===m&&a.a.createElement(Y.n,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,size:"lg"},P),_&&"lego-closeup"!==m&&a.a.createElement(I,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,positionRelativeToAnchor:!t,size:"lg"},P)))}}V(ee,"defaultProps",{variant:"pin",renderSavedStatus:({savedInfo:e,variant:t})=>a.a.createElement(Z,{savedInfo:e,variant:t})});t.default=a.a.memo(Object(R.compose)(y.e,Object(i.connect)(({location:e,history:t,mostRecentBoard:n,pins:o,ui:a,viewer:i},{pin:{id:r}})=>{const s=o[r],{postRepinMoreIdeasUpsell:c}=a;return{carousel_data:s&&s.carousel_data,previousHistory:t.previous,isLimitedLogin:i.isLimitedLogin,savedInfo:s&&s.savedInfo,selectedItem:s&&s.selectedItem,reduxLocation:e,postRepinMoreIdeasUpsell:c,mostRecentBoard:n,viewerUserId:i.id}},e=>({incrementBoardPinCount:({boardId:t,sectionId:n})=>e(Object(I.d)({boardId:t,sectionId:n,increment:1})),save:t=>e(Object(M.a)(t)),unsave:t=>e(Object(M.d)(t)),selectBoardOrSection:t=>e(Object(M.b)(t)),setMostRecentBoard:(t,n,o)=>e(Object(P.a)(t,n,o)),searchQueryInvalidated:t=>e(Object(D.b)(t)),showRepinAnimation:t=>e(Object(k.c)(t)),updateUserPinCount:t=>e(Object(j.b)({userId:t,increment:1}))})),K.c,Object(W.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:()=>({field_set_key:"board_picker"})}),Object(W.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsShortListResource",options:e=>({pin_id:e.pin.id,shortlist_length:2,num_shortlist_suggestions:2,suggestions_only:!0,min_confidence:.5})}),q.a)((function(e){const{suggestedBoardsShortListResource:t,initialSelection:n,mostRecentBoard:o}=e,i=Object(Q.b)();if(n)return a.a.createElement(ee,Object.assign({},e,{boardPickerStopwatch:i,postRepinUpsellDisabled:!0,unselectedText:n.title}));const r=t&&t.data&&t.data[0];return a.a.createElement(Y.d,{overflow:"hidden"},a.a.createElement(ee,Object.assign({},e,{boardPickerStopwatch:i,initialSelection:t&&t.isLoaded&&r&&{boardId:r.id,title:r.name,url:r.url}||t&&t.isLoaded&&!r&&o&&{boardId:o.id,title:o.name,url:o.url}||void 0,unselectedText:t&&t.isLoaded?h.a._("Select","BetterSave label to pick a board from the list","BetterSave label to pick a board from the list"):"..."})))})))},jZhD:function(e,t,n){n.d(t,"a",(function(){return r}));var o=n("q1tI"),a=(n("17x9"),n("pdBG"));function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class r extends o.Component{constructor(...e){super(...e),i(this,"searchCache",Object.create(null)),i(this,"lastSearchedQuery",null),i(this,"search",e=>{this.lastSearchedQuery=e,e in this.searchCache?this.props.onTypeaheadSuggestionsChange(this.searchCache[e],e):this.provider.search(e,({items:t})=>{this.searchCache[e]=t,e===this.lastSearchedQuery&&this.props.onTypeaheadSuggestionsChange(t,e)})})}componentDidMount(){const e=this.props.resourceOptions||{};this.provider=new a.a({resource_name:this.props.resourceName,...e});const{value:t}=this.props;null!=t&&this.props.allowSearchOnMount&&this.search(this.props.value)}UNSAFE_componentWillReceiveProps({value:e}){null!=e&&e!==this.props.value&&this.search(e)}render(){return this.props.children||null}}i(r,"defaultProps",{resourceName:"TypeaheadResource"})},"mVx/":function(e,t,n){var o=n("XKAG")(n("JELi"));e.exports=o},nKlH:function(e,t,n){n.d(t,"a",(function(){return r}));var o=n("q1tI"),a=n.n(o),i=n("n6mq");function r(e){const{accessibilityLabel:t,focused:n,id:r,onBlur:s,onChange:c,onFocus:l,placeholder:d,value:u}=e,h=Object(o.useRef)(null);return Object(o.useEffect)(()=>{if(n){const e=h.current;window.requestAnimationFrame(()=>{const t=e&&e.querySelector("input");t instanceof HTMLInputElement&&t.focus()})}},[n]),a.a.createElement(i.d,{ref:h},a.a.createElement(i.H,{accessibilityLabel:t,id:r,onBlur:s,onChange:c,onFocus:l,placeholder:d,size:"lg",value:u}))}},pdBG:function(e,t,n){var o=n("AHhP"),a=n.n(o);const i=function(e,t){this.uid=e,this.item=t,this.next=null,this.prev=null},r=function(e){this._maxNumItems=e||10,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null};r.prototype.set=function(e,t){let n=this._uidToData[e];n||(n=new i(e,t),this._uidToData[e]=n,this._numItems+=1),this._moveToFront(n),this._numItems>this._maxNumItems&&this._evict()},r.prototype.get=function(e){const t=this._uidToData[e];return t?(this._moveToFront(t),t.item):null},r.prototype.remove=function(e){const t=this._uidToData[e];t&&(delete this._uidToData[e],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},r.prototype._moveToFront=function(e){this._firstData!==e&&(this._firstData?(this._lastData===e&&(this._lastData=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this._firstData.prev=e,e.next=this._firstData,e.prev=null,this._firstData=e):(this._firstData=e,this._lastData=e))},r.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1};var s=r,c=n("eOdZ"),l=n("mBfy");const d=function(e){e=e||{},this.tags=e.tags,this.enable_recent_queries=!!e.enable_recent_queries,this.minimum_term_character_length=e.minimum_term_character_length||0,this.bypass_lru_cache=e.bypass_lru_cache;const t={tags:e.tags,pin:e.pin_id},n=e.num_places;n?t.num_places=n:t.count="count"in e?e.count:5,e.exclude_non_followers&&(t.exclude_non_followers=!0),e.field_set_key&&(t.field_set_key=e.field_set_key),e.pin_scope&&(t.pin_scope=e.pin_scope),e.suggestion_type&&(t.suggestion_type=e.suggestion_type);let o="TypeaheadResource";e.resource_name&&(o=e.resource_name),this.searchResource=c.a.create(o,t),this.itemsCache=new s};Object.assign(d.prototype,a.a),Object.assign(d.prototype,{search(e,t){let n;if(!e&&"pinners_and_contacts"===this.tags)return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&l.default.isLimitedLogin())return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&this.enable_recent_queries&&l.default&&l.default.isAuthenticated())n="recent_search";else{const n=this.bypass_lru_cache?{}:this.itemsCache.get(e);if(n){const o=n.items;if(o&&o.length){this.abortSearch();const a=n.hint;return void this.publishData(e,o,a,t)}}}e.length>=this.minimum_term_character_length?this.fetch(e,n,t):this.publishData(e,[],{},t)},getResource(){return this.searchResource},abortSearch(){this.getResource().abort()},publishData(e,t,n,o){const a={term:e,items:t,hint:n};this.trigger("data",a),o&&o(a)},setAutocompleteScope(e){this.getResource().set("autocompleteScope",e)},fetch(e,t,n){const o=this.getResource();if(o.isCalling()){const t=o.get("term");if(e===t)return;this.abortSearch()}""!==this.tags&&(o.set("term",e),o.set("tags",t||this.tags),o.resetBookmark(),o.callGet({showError:!1}).then(t=>{const o=t.resource_response.data,a=o.items,i=o.hint||{},r={hint:i,items:a};this.cacheData(e,r),this.publishData(e,a,i,n)},e=>{this.trigger("fetchError",e)}),this.warm=!0)},removeCacheForTerm(e){this.itemsCache.remove(e)},cacheData(e,t){this.itemsCache.set(e,t)},prefetch(){if(this.warm)return;c.a.create("TypeaheadPrepareResource").callGet({showError:!1}),this.warm=!0}});t.a=d}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/PinBetterSaveCommon-a8256e3bd948e0b08b37.mjs.map